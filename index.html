<!DOCTYPE html>
<html>

<head>
  <title></title>
  <script src="konbi.js"></script>
</head>

<body>
  <div>
    <form>
      <div>
        <input id="appleText" type="text" name="apple">
      </div>
      <div>
        <input type="text" name="banana">
      </div>
      <div>
        <button id="addBtn" type="button">Add</button>
      </div>
    </form>
    <div id="atom"></div>
    <table>
      <thead>
        <tr>
          <th>apple</th>
          <th>banana</th>
        </tr>
      </thead>
      <tbody>
        <tr style="display: none;">
          <td class="apple"></td>
          <td class="banana"></td>
        </tr>
      </tbody>
    </table>
    <div id="atom"></div>
  </div>
  <script type="text/javascript">
    var k = new Konbi({
      entities: {
        apple: "",
      },
    });

    k.entities.on("apple@change", function (event) {
      console.log("dispatched change x");
      console.log(event);
      console.log(this);

      document.getElementById("appleText").value = event.value;
    });

    document.getElementById("addBtn").addEventListener("click", function (event) {
      k.entities.apple = (new Date()).toISOString();
    });
    
    // document.getElementById("appleText").addEventListener("change", function (event) {
    //   console.log(event);
    // });

    console.log(k);
  </script>
</body>

</html>